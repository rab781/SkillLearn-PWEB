<!DOCTYPE html>
<html>
<head>
    <title>Test Quiz Options</title>
    <style>
        .option-container {
            background: #f9fafb;
            padding: 16px;
            margin: 8px 0;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        .option-container:hover {
            background: #dbeafe;
        }
        .option-container.selected {
            background: #dbeafe;
            border-color: #3b82f6;
        }
        label {
            margin-left: 16px;
            flex: 1;
            cursor: pointer;
            font-weight: 500;
            color: #374151;
        }
    </style>
</head>
<body>
    <h1>Test Quiz Options Rendering</h1>
    <div id="test-container"></div>

    <script>
        // Simulate quiz data
        const testQuestion = {
            question_id: 1,
            pertanyaan: 'Tag HTML untuk heading level 1 adalah:',
            pilihan_jawaban: '["<h1>","<heading1>","<head1>","<title>"]',
            urutan_pertanyaan: 1
        };

        function testLoadQuestion() {
            const container = document.getElementById('test-container');
            
            // Parse options
            let options = testQuestion.pilihan_jawaban;
            if (typeof options === 'string') {
                try {
                    options = JSON.parse(options);
                    console.log('Parsed options:', options);
                } catch (e) {
                    console.error('Failed to parse options:', options);
                    options = [];
                }
            }

            let optionsHtml = '';
            options.forEach((option, optionIndex) => {
                const optionId = `question_${testQuestion.question_id}_option_${optionIndex}`;
                console.log(`Creating option ${optionIndex + 1}: "${option}"`);
                
                const escapedOption = String(option).replace(/"/g, '&quot;').replace(/'/g, '&#39;');
                const safeOption = String(option).replace(/</g, '&lt;').replace(/>/g, '&gt;');
                
                optionsHtml += `
                    <div class="option-container" onclick="selectOption(this, '${escapedOption}')">
                        <input type="radio" id="${optionId}" name="question_${testQuestion.question_id}" value="${escapedOption}">
                        <label for="${optionId}">
                            ${safeOption}
                        </label>
                    </div>
                `;
            });
            
            console.log('Generated HTML:', optionsHtml);

            const questionDiv = document.createElement('div');
            questionDiv.innerHTML = `
                <h3>Soal 1</h3>
                <p>${testQuestion.pertanyaan}</p>
                <div>
                    ${optionsHtml}
                </div>
            `;

            container.appendChild(questionDiv);
            
            // Debug: Check rendered options
            const renderedOptions = questionDiv.querySelectorAll('.option-container');
            console.log(`Rendered ${renderedOptions.length} options`);
            renderedOptions.forEach((opt, i) => {
                console.log(`Option ${i + 1} text:`, opt.querySelector('label').textContent);
            });
        }

        function selectOption(element, answer) {
            // Remove previous selection
            document.querySelectorAll('.option-container').forEach(opt => {
                opt.classList.remove('selected');
                opt.querySelector('input').checked = false;
            });
            
            // Select current
            element.classList.add('selected');
            element.querySelector('input').checked = true;
            console.log('Selected:', answer);
        }

        // Run test
        testLoadQuestion();
    </script>
</body>
</html>
